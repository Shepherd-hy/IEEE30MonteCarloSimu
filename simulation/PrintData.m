function out = PrintData(simout)
% =================================================
% Save simulation results to database
% -------------------------------------------------
% simout: Simulation result structure in workspace.
% =================================================

% Initialize column names
columns = ["V1", "V2", "V3", "V4", "V5", "V6", "V7", "V8", "V10", "V12", ...
           "V14", "V15", "V16", "V17", "V18", "V19", "V20", "V21", "V22", ...
           "V23", "V24", "V25", "V26", "V27", "V28", "V29", "V30", ...
           "I12", "I21", "I13", "I31", "I24", "I42", "I25", "I52", ...
           "I34", "I43", "I26", "I62", "I46", "I64", "I57", "I75", ...
           "I67", "I76", "I68", "I86", "I628", "I286", "I828", "I288", ...
           "I1017", "I1710", "I1020", "I2010", "I1021", "I2110", "I1022", "I2210", ...
           "I1214", "I1412", "I1215", "I1512", "I1216", "I1612", "I1415", "I1514", ...
           "I1518", "I1815", "I1523", "I2315", "I1617", "I1716", "I1819", "I1918", ...
           "I1920", "I2019", "I2122", "I2221", "I2224", "I2422", "I2324", "I2423", ...
           "I2425", "I2524", "I2526", "I2625", "I2527", "I2725", "I2729", "I2927", ...
           "I2730", "I3027", "I2930", "I3029"];
outputs = cell(1, length(columns));
for i = 1:length(columns)
    outputs{i} = Extract(simout, char(columns(i)));
end
out = strjoin(outputs, ',');
end

function out = Extract(simout, columnName)
ts = simout.get(columnName);
M = size(ts.Data, 1);
MagA = ts.Data(M, 1);   MagB = ts.Data(M, 2);   MagC = ts.Data(M, 3);
PhA = ts.Data(M, 4);    PhB = ts.Data(M, 5);    PhC = ts.Data(M, 6);
out = sprintf('%g,%g,%g,%g,%g,%g', MagA, MagB, MagC, PhA, PhB, PhC);
end